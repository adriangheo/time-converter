<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/luxon/2.3.1/luxon.min.js"></script>
    <title>TimeConv</title>

    <script>
        jQuery(document).ready(function() {
            jQuery(".timeconvertorchild").css({
                'font-size': '0.8em'
                    // , 'border-bottom': '3px solid #0eb48d'
            });



            jQuery(".split-3-columns").css({
                'display': 'grid',
                'grid-template-columns': 'repeat(auto-fit, minmax(100px, 1fr))',
                'font-size': '0.8em'
            });


            // jQuery(".group-cls-name").css('color','#9fbe92');
            jQuery(".tz-bold").css({
                'font-weight': 'bold'
            });


            // jQuery(".boxbox").css('border-bottom','3px solid #0eb48d');

            jQuery(".tz-details").css({
                'font-size': '0.8em'
            });

            jQuery(".nowrp").css({
                'white-space': 'nowrap'
            });

            // jQuery('.minwidth').css('min-width', '500px');

            jQuery('.rightbox').css({
                'padding-left': '1em'
            });

            // jQuery(".timeconvertorparent").css('border','3px solid #0eb48d');
            // jQuery(".timeconvertorparent").css('background-color','#ade2d6');

        });
    </script>
</head>

<body>


    <div class="timeconvertorparent">
        <div class="date-and-time-of-first-course">31-Dec-2022 22:00</div>
        <div class="date-of-second-course">01-Jan-2023</div>
        <div class="total-course-minutes">95</div>
        <div class="timeconvertorchild">

            <div class="headerbox boxbox">
                <p class="tz-bold"><span class="group-cls-name">Group A</span> starting date: <span class="usr-strt-date">March 10th</span></p>
            </div>

        </div>
        <div class="conv-local-zone timeconvertorchild split-3-columns user-tz">
            <div class="leftbox boxbox">
                <p><span class="tz-bold minwidth">Your time </span> </p>
                <p class="user-cls-time tz-details">Eastern Standard Time</p>
            </div>

            <div class="middlebox boxbox">
                <p class="schedule-text day-of-week">Sun &amp; Wed</p>
            </div>


            <div class="rightbox boxbox boxbox ">
                <p class="user-cls-hour tz-bold"> <span class='nowrp start-hr'>5:00 PM</span> - <span class='nowrp end-hr'>6:00 PM</span></p>
                <p class="tz-details"><span class='nowrp'>Sun, Mar 6 2022</span> - <span class='nowrp'>Sun, Mar 6 2022</span></p>
            </div>
        </div>

        <div class="conv-chosen-zone timeconvertorchild split-3-columns new-york-tz">
            <div class="leftbox boxbox">
                <p><span class="minwidth"><span class="tz-bold ">EST </span><span class="tz-details">(New York)</span></span>
                </p>
                <p class="chosen-timezone tz-details">America/New_York</p>
            </div>

            <div class="middlebox boxbox">
                <p class="schedule-text day-of-week"></p>
                <!-- <p class="schedule-text day-of-week">Sun &amp; Wed</p> -->

            </div>

            <div class="rightbox boxbox">
                <p class="chosen-hour tz-bold"> <span class='nowrp start-hr'>10:00 AM</span> - <span class='nowrp end-hr'>11:00 AM</span></p>
                <p class="tz-details"><span class='nowrp'>Sun, Mar 6 2022</span> - <span class='nowrp'>Sun, Mar 6 2022</span></p>
            </div>
        </div>
    </div>

    <hr>
    <hr>

    <div class="timeconvertorparent">
        <div class="date-and-time-of-first-course">20-Jun-2022 23:00</div>
        <div class="date-of-second-course">22-Jun-2022</div>
        <div class="total-course-minutes">90</div>

        <div class="timeconvertorchild">

            <div class="headerbox boxbox">
                <p class="tz-bold"><span class="group-cls-name">Group A</span> starting date: <span class="usr-strt-date">March 10th</span></p>
            </div>

        </div>
        <div class="conv-local-zone timeconvertorchild split-3-columns user-tz">
            <div class="leftbox boxbox">
                <p><span class="tz-bold minwidth">Your time </span> </p>
                <p class="user-cls-time tz-details">Eastern Standard Time</p>
            </div>

            <div class="middlebox boxbox">
                <p class="schedule-text day-of-week">Sun &amp; Wed</p>
            </div>


            <div class="rightbox boxbox boxbox ">
                <p class="user-cls-hour tz-bold"> <span class='nowrp start-hr'>5:00 PM</span> - <span class='nowrp end-hr'>6:00 PM</span></p>
                <p class="tz-details full-date"><span class='nowrp'>Sun, Mar 6 2022</span> - <span class='nowrp'>Sun, Mar 6 2022</span></p>
            </div>
        </div>

        <div class="conv-chosen-zone timeconvertorchild split-3-columns new-york-tz">
            <div class="leftbox boxbox">
                <p><span class="minwidth"><span class="tz-bold ">EST </span><span class="tz-details">(New York)</span></span>
                </p>
                <p class="chosen-timezone tz-details">America/New_York</p>
            </div>

            <div class="middlebox boxbox">
                <p class="schedule-text day-of-week"></p>
                <!-- <p class="schedule-text day-of-week">Sun &amp; Wed</p> -->

            </div>

            <div class="rightbox boxbox">
                <p class="chosen-hour tz-bold"> <span class='nowrp start-hr'>10:00 AM</span> - <span class='nowrp end-hr'>11:00 AM</span></p>
                <p class="tz-details full-date"><span class='nowrp'>Sun, Mar 6 2022</span> - <span class='nowrp'>Sun, Mar 6 2022</span></p>
            </div>
        </div>
    </div>


    <script>
        // jQuery('.timeconvertorparent').each(function() {

        //VERY IMPORTANT - keep EXACTLY this format "dd-mmm-yyyy hh:mm" (eg. if day is smaller than 10 add 0 in front) 
        // var date_and_time_of_first_course = jQuery(this).find('.date-and-time-of-first-course').text();
        var date_and_time_of_first_course = "20-Jun-2022 15:45";



        //VERY IMPORTANT - keep EXACTLY this format "dd-mmm-yyyy" 
        // var date_of_second_course = jQuery(this).find('.date-of-second-course').text();
        var date_of_second_course = "22-Jun-2022";
        // var total_course_minutes = jQuery(this).find('.total-course-minutes').text();
        var total_course_minutes = 90;

        function getMonthFromString(mon) {
            return new Date(Date.parse(mon + " 1, 2012")).getMonth() + 1;
        }


        var day_1st = 'Sun';
        var day_2nd = 'Wed';
        var myMonth = getMonthFromString(date_and_time_of_first_course.substring(3, 6));
        var cDay1st = date_and_time_of_first_course.substring(0, 2);
        var cHour = date_and_time_of_first_course.substring(12, 14);
        var cMinute = date_and_time_of_first_course.substring(15, 17)



        // ↓↓↓ initial LuxonJs Object (in New York time)
        let dt1StartNY = luxon.DateTime.fromObject({
            month: myMonth,
            day: cDay1st,
            hour: cHour,
            minute: cMinute
        }, {
            zone: 'America/New_York'
        });
        // ↑↑↑ initial LuxonJs Object


        // ↓↓↓ get days of the week for 1st and 2nd day of course (New York Time)
        let dt1StartNYweekday = dt1StartNY.weekdayShort;


        let dt2StartNY = dt1StartNY.set({
            day: date_of_second_course.substring(0, 2),
            month: getMonthFromString(date_of_second_course.substring(3, 6))
        });

        let dt2StartNYweekday = dt2StartNY.weekdayShort;
        // ↑↑↑  get days of the week for 1st and 2nd day of course (New York Time)




        // ↓↓↓ get date difernce in days between 1st and 2nd day of course
        let diff = dt2StartNY.diff(dt1StartNY, ["days"]);
        let diffInDays = diff.days;


        // ↑↑↑get date difernce in days between 1st and 2nd day of course




        // ↓↓↓ variables partaining to America/New_York dates and times
        // reference link: https://github.com/moment/luxon/blob/master/docs/formatting.md#user-content-intldatetimeformat
        let dtHourStartNY = dt1StartNY.toLocaleString({
            hour: 'numeric',
            minute: '2-digit'
        });

        // let dtHourEndNY = dt1EndNY.get('hour');
        let dtHourEndNYobj = dt1StartNY.plus({
            minutes: total_course_minutes
        })

        let dtHourEndNY_string = dtHourEndNYobj.toLocaleString({
            hour: 'numeric',
            minute: '2-digit'
        });

        // reference link: https://github.com/moment/luxon/blob/master/docs/zones.md#user-content-creating-datetimes
        // reference link:https://github.com/moment/luxon/blob/master/docs/formatting.md#user-content-table-of-tokens
        let dtLocalZoneNY = dt1StartNY.toFormat("ZZZZZ");
        // ↑↑↑ variables partaining to America/New_York dates and times


        //IMPORTANT PART
        // ↓↓↓ get full date for 1st day of course, at start of course, in User TimeZone
        let dt1StartNYFullDate = "" + dt1StartNY.toFormat("ccc, LLL dd yyyy -- HH:mm");
        console.log('dt1StartNYFullDate');
        console.log(dt1StartNYFullDate);
        // ↑↑↑ get full date for 1st day of course, at start of course, in User TimeZone


        // ↓↓↓ get full date for 1st day of course, at end of course, in User TimeZone
        let dt1EndNYFullDate = "" + dtHourEndNYobj.toFormat("ccc, LLL dd yyyy -- HH:mm");
        console.log('dt1EndNYFullDate');
        console.log(dt1EndNYFullDate);
        // ↑↑↑ get full date for 1st day of course, at end of course, in User TimeZone


        // ↓↓↓ variables partaining to UserTimeZone dates and times
        let dtLocalUsrTz = dt1StartNY.setZone(luxon.DateTime.local().zoneName).toFormat("ZZZZZ");

        let dt1UsrTz = dt1StartNY.setZone(luxon.DateTime.local().zoneName);
        let dt1HourStartUsrTz = dt1UsrTz.toLocaleString({
            hour: 'numeric',
            minute: '2-digit'
        });

        let dt2HourEndUsrTz = dt1UsrTz.plus({
            minutes: total_course_minutes
        });

        let dt2HourEndUsrTzString = dt2HourEndUsrTz.toLocaleString({
            hour: 'numeric',
            minute: '2-digit'
        });
        // ↑↑↑ variables partaining to UserTimeZone dates and times




        // ↓↓↓ get days of the week for 1st and 2nd day of course (User TimeZone)
        let dt1StartUsrTzWeekday = dt1UsrTz.weekdayShort;

        let dt2StartUsrTzWeekday = dt1UsrTz.plus({
            days: diffInDays
        }).weekdayShort;
        // ↑↑↑  get days of the week for 1st and 2nd day of course (User TimeZone)


        // ↓↓↓ get month and day for title (User TimeZone)
        let dt1UsrMonthAndDay = "" + dt1UsrTz.toFormat("LLL dd") + getNumberSuffix(dt1UsrTz.toFormat("ddt2HourEndUsrTzStringd"));
        // ↑↑↑ get month and day for title (User TimeZone)


        // ↓↓↓ get full date for 1st day of course, at start of course, in User TimeZone
        let dt1StartUsrFullDate = "" + dt1UsrTz.toFormat("ccc, LLL dd yyyy -- HH:mm");
        console.log('dt1StartUsrFullDate');
        console.log(dt1StartUsrFullDate);
        // ↑↑↑ get full date for 1st day of course, at start of course, in User TimeZone


        // ↓↓↓ get full date for 1st day of course, at end of course, in User TimeZone
        let dt1EndUsrFullDate = "" + dt2HourEndUsrTz.toFormat("ccc, LLL dd yyyy -- HH:mm");
        console.log('dt1EndUsrFullDate');
        console.log(dt1EndUsrFullDate);
        // ↑↑↑ get full date for 1st day of course, at end of course, in User TimeZone


        // jQuery(this).find('.usr-strt-date').text(dt1UsrMonthAndDay);

        // jQuery(this).find('.time-conv .leftbox .your-time').text("" + dtLocalZoneNY);

        // jQuery(this).find('.new-york-tz .day-of-week').text("" + dt1StartNYweekday + " & " + dt2StartNYweekday);
        // jQuery(this).find('.rightbox .schedule-text').text("" + dtHourStartNY + " - " + dtHourEndNY_string);
        // jQuery(this).find('.chosen-hour').text("" + dtHourStartNY + " - " + dtHourEndNY_string);


        // jQuery(this).find('.user-tz .day-of-week').text("" + dt1StartUsrTzWeekday + " & " + dt2StartUsrTzWeekday);
        // jQuery(this).find('.user-cls-time').text(dtLocalUsrTz);
        // jQuery(this).find('.user-cls-hour .start-hr').text(dt1HourStartUsrTz);
        // jQuery(this).find('.user-cls-hour .end-hr').text(dt2HourEndUsrTzString);



        jQuery('.usr-strt-date').text(dt1UsrMonthAndDay);

        jQuery('.time-conv .leftbox .your-time').text("" + dtLocalZoneNY);

        jQuery('.new-york-tz .day-of-week').text("" + dt1StartNYweekday + " & " + dt2StartNYweekday);
        jQuery('.timeconvertorparent .rightbox .schedule-text').text("" + dtHourStartNY + " - " + dtHourEndNY_string);
        jQuery('.chosen-hour').text("" + dtHourStartNY + " - " + dtHourEndNY_string);


        jQuery('.user-tz .day-of-week').text("" + dt1StartUsrTzWeekday + " & " + dt2StartUsrTzWeekday);
        jQuery('.user-cls-time').text(dtLocalUsrTz);
        jQuery('.user-cls-hour .start-hr').text(dt1HourStartUsrTz);
        jQuery('.user-cls-hour .end-hr').text(dt2HourEndUsrTzString);





        function getNumberSuffix(num) {
            const th = 'th'
            const rd = 'rd'
            const nd = 'nd'
            const st = 'st'

            if (num === 11 || num === 12 || num === 13) return th

            let lastDigit = num.toString().slice(-1)

            switch (lastDigit) {
                case '1':
                    return st
                case '2':
                    return nd
                case '3':
                    return rd
                default:
                    return th
            }
        }


        // });
    </script>


</body>

</html>